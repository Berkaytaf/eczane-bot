name: ğŸš€ Lead Gen Master (Eczane & Ä°ÅŸletme AvcÄ±sÄ±)

on:
  workflow_dispatch:
    inputs:
      sehir:
        description: 'Hangi Åehir? (Ã–rn: Istanbul)'
        required: true
        default: 'Istanbul'
      kategori:
        description: 'Ne ArÄ±yoruz? (Ã–rn: Eczane, Restoran, HVAC)'
        required: true
        default: 'Eczane'

jobs:
  scrape_job:
    runs-on: ubuntu-latest
    permissions:
      contents: write # DosyayÄ± repoya geri yazmak iÃ§in gerekebilir
      
    steps:
      - name: ğŸ“‚ KodlarÄ± Ã‡ek
        uses: actions/checkout@v4

      - name: ğŸ Python Kur
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: ğŸ“¦ KÃ¼tÃ¼phaneleri YÃ¼kle
        run: |
          pip install playwright pandas openpyxl
          playwright install chromium

      - name: ğŸ¤– Botu AteÅŸle
        # Kodun iÃ§indeki sys.argv[1] ve sys.argv[2] kÄ±sÄ±mlarÄ±na bu girdileri gÃ¶nderir
        run: python pro_scraper.py "${{ github.event.inputs.sehir }}" "${{ github.event.inputs.kategori }}"

      - name: ğŸ“Š Sonucu Repoya Kaydet (Opsiyonel)
        run: |
          git config --global user.name "LeadGenBot"
          git config --global user.email "bot@github.com"
          git add *.xlsx || echo "Dosya bulunamadÄ±"
          git commit -m "âœ… Veri Ã‡ekildi: ${{ github.event.inputs.sehir }} - ${{ github.event.inputs.kategori }}" || exit 0
          git push

      - name: ğŸ“¥ Excel DosyasÄ±nÄ± HazÄ±rla (Artifact)
        # Bu adÄ±m, dosyayÄ± "Ä°ndirilebilir" hale getirir. MÃ¼ÅŸteriye sunarken en iyisi budur!
        uses: actions/upload-artifact@v4
        with:
          name: ${{ github.event.inputs.sehir }}-${{ github.event.inputs.kategori }}-Listesi
          path: "*.xlsx"
